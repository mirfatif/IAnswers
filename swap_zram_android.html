<!DOCTYPE html><html lang="en"><head><script src="js/main-min.js"></script><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="author" content="Irfan Latif"><meta property="og:type" content="article"><meta property="article:author" content="https://mirfatif.github.io/"><meta property="og:url" content="https://mirfatif.github.io/IAnswers/swap_zram_android"><meta property="og:image" content="https://mirfatif.github.io/IAnswers/img/og_image.png"><meta property="og:image:width" content="256"><meta property="og:image:height" content="256"><meta property="og:title" content="What's the purpose of swap and zRAM on Android?"><meta property="og:description" content="Find out how Android manages RAM and how much you need to be concerned about this. This helps preserving system resources and improves performance."><meta name="twitter:card" content="summary"><meta name="twitter:title" content="What's the purpose of swap and zRAM on Android?"><meta name="twitter:description" content="Find out how Android manages RAM and how much you need to be concerned about this. This helps preserving system resources and improves performance."><title>What's the purpose of swap and zRAM on Android?</title><meta name="description" content="Find out how Android manages RAM and how much you need to be concerned about this. This helps preserving system resources and improves performance."><link rel="canonical" href="https://mirfatif.github.io/IAnswers/swap_zram_android"><link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png"><link rel="icon" type="image/x-icon" href="favicon/favicon.ico"><link rel="manifest" href="favicon/site.webmanifest"></head><body style="display:none"><div is="custom-div" data-custom-type="sidebar" class="sidebar"><div class="sidebar-header"><img alt="Logo" class="sidebar-header" src="icons/trans_logo.webp"></div><div is="custom-div" data-custom-type="sidebar-contents" class="sidebar-contents"><h2>Contents</h2><h3>CPU</h3><ul class="no-bullets"><li class="contents"><a class="contents" href="cpu_usage_per_process_android.html">How to view CPU usage of apps or processes on Android?</a></li><li class="contents"><a class="contents" href="find_cpu_hog_android.html">How to find out which app hogs CPU on your Android device?</a></li></ul><h3>RAM</h3><ul class="no-bullets"><li class="contents"><a class="contents" href="ram_swap_usage_android.html">How to view RAM and swap usage on Android?</a></li><li class="contents"><a class="contents" href="ram_usage_per_process_android.html">How to view RAM usage of apps or processes on Android?</a></li><li class="contents"><a class="contents" href="swap_usage_per_process_android.html">How to view SWAP usage of apps or processes on Android?</a></li><li class="contents"><a class="contents" href="android_high_ram_usage.html">Why does Android OS use so much RAM?</a></li><li class="contents"><a class="contents" href="find_free_ram_android.html">How much free RAM does my Android device have?</a></li><li class="contents"><a class="contents" href="should_free_ram_in_android.html">Should I free RAM on Android?</a></li><li class="contents"><a class="contents" href="how_to_free_ram_in_android.html">How to free RAM on Android?</a></li><li class="contents"><a class="contents" href="swap_zram_android.html">What's the purpose of swap and zRAM on Android?</a></li></ul><h3>Background Apps</h3><ul class="no-bullets"><li class="contents"><a class="contents" href="view_android_background_apps.html">How to view background apps running on Android?</a></li><li class="contents"><a class="contents" href="view_android_background_services.html">How to view background services running on Android?</a></li><li class="contents"><a class="contents" href="why_android_apps_run_in_background.html">Why do apps run in background on Android?</a></li><li class="contents"><a class="contents" href="stop_background_apps_in_android.html">How to stop background apps on Android?</a></li><li class="contents"><a class="contents" href="prevent_android_apps_restart_background.html">How to prevent Android apps from restarting in background?</a></li><li class="contents"><a class="contents" href="prevent_android_apps_start_on_boot.html">How to prevent Android apps from starting on device boot?</a></li><li class="contents"><a class="contents" href="find_cached_android_apps.html">How to find out which Android apps are in &#x201c;Cached&#x201d; state?</a></li></ul><h3>Power</h3><ul class="no-bullets"><li class="contents"><a class="contents" href="android_apps_drain_battery.html">Which Android apps are draining battery?</a></li><li class="contents"><a class="contents" href="find_battery_hog_android.html">How to find battery hogs on Android?</a></li><li class="contents"><a class="contents" href="android_apps_hold_wake_locks.html">Which Android apps are holding wake locks?</a></li><li class="contents"><a class="contents" href="get_wake_lock_history_android.html">How to get wake locks history on Android?</a></li><li class="contents"><a class="contents" href="stop_android_app_hold_wakelock.html">How to stop an Android app from holding wake lock?</a></li></ul><h3>Permissions</h3><ul class="no-bullets"><li class="contents"><a class="contents" href="android_appop_manifest_permissions.html">What are manifest permissions and AppOps?</a></li><li class="contents"><a class="contents" href="android_permission_types.html">What are different permission types on Android?</a></li><li class="contents"><a class="contents" href="what_are_android_app_permissions.html">What are Android app permissions?</a></li><li class="contents"><a class="contents" href="find_android_app_display_over_other_apps.html">How to find which Android apps display ads over other apps?</a></li><li class="contents"><a class="contents" href="stop_android_app_display_over_other_apps.html">How to stop Android apps from displaying ads over other apps?</a></li><li class="contents"><a class="contents" href="stop_android_app_vibration.html">How to stop an Android app from making vibration?</a></li><li class="contents"><a class="contents" href="stop_android_app_read_clipboard.html">How to stop an Android app from reading clipboard?</a></li><li class="contents"><a class="contents" href="stop_android_app_run_foreground_service.html">How to stop an Android app from running a foreground service?</a></li><li class="contents"><a class="contents" href="stop_android_app_show_persistent_notification.html">How to stop an Android app from showing persistent notification?</a></li></ul><h3>Storage</h3><ul class="no-bullets"><li class="contents"><a class="contents" href="android_app_kill_flash_storage.html">Which Android app is killing the flash storage?</a></li></ul></div></div><div class="content-header"><img alt="logo" class="content-header" src="icons/trans_logo.webp"></div><div is="custom-div" data-custom-type="content" class="content"><div class="content-top-padding content-bottom-padding"><div is="custom-div" data-custom-type="dark-theme-switch" style="display:none"><label class="switch no-link-tap-color"><input class="switch" type="checkbox"> <span class="switch-slider"></span></label></div><form class="index-button" title="Index" action="https://mirfatif.github.io/IAnswers" style="float:right"><button class="header-row1" type="submit"><svg class="small-button-logo" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg"><g class="fill-theme-color"><path d="m30 47.299v8.4483h17.701v-16.897h-17.701z"/><path d="m64.598 47.299v8.4483h105.4v-16.897h-105.4z"/><path d="m30 82.299v8.8506h17.782l-0.24138-8.6897-0.24138-8.6092-8.6092-0.24138-8.6897-0.24139z"/><path d="m65.161 74.011c-0.32184 0.24138-0.56322 4.2644-0.56322 8.8506v8.2874h105.4v-17.701h-52.138c-28.724 0-52.46 0.24138-52.701 0.56323z"/><path d="m30 117.7v8.931l8.6897-0.24138 8.6092-0.24138 0.24138-8.6897 0.24138-8.6092h-17.782z"/><path d="m64.759 117.46 0.24138 8.6897 52.54 0.24138 52.46 0.16092v-17.701h-105.48z"/><path d="m30 152.7v8.4483h17.701v-16.897h-17.701z"/><path d="m64.598 152.7v8.4483h105.4v-16.897h-105.4z"/></g></svg></button></form><div style="clear:both"></div></div><div class="content-top-padding" style="text-align:end"><form class="header-row-button" action="https://mirfatif.github.io/WhatsRunning/help/en" target="_blank"><button class="header-row2" type="submit"><img alt="logo" class="button-logo" src="https://mirfatif.github.io/mirfatif/logos/w_run.png"> <b class="header-row2-button">WhatsRunning</b></button></form><form class="header-row-button" action="https://mirfatif.github.io/PermissionManagerX/help/help" target="_blank"><button class="header-row2" type="submit"><img alt="logo" class="button-logo" src="https://mirfatif.github.io/mirfatif/logos/pmx.png"> <b class="header-row2-button">PMX</b></button></form></div><div class="card"><h2>What's the purpose of swap and zRAM on Android?</h2><hr class="dim"><p>The core operating system in Android is <a href="https://en.wikipedia.org/wiki/Linux_kernel">Linux kernel</a>. All the apps we use run as native Linux processes. Executable code is saved as a file (a compiled binary or library or virtual machine code) on storage like eMMC, SD card, SSD, hard disk etc. When a process starts, its code is loaded to RAM so that CPU can perform operations on it. Then process keeps on allocating more RAM as it needs and freeing when not needed. But what if there are too many processes running and RAM becomes completely filled?</p><p>RAM is broken up into pages; typically 4KB each. So Linux kernel starts freeing up RAM by removing pages which are not <code>shared</code> by other processes and are not <code>dirty</code> (i.e. not been modified by any process). But what if the process has made some changes to the pages e.g. when you edit or create a file in a text editor app?</p><p>In this case Linux kernel looks for the pages which have not been <i>touched</i> (changed or used) in last few seconds or minutes. So these pages are temporarily moved to a portion on storage called <b>swap</b>. This portion can be a partition or a file. And as soon as the process needs one of such pages, they are <i>swapped</i> back to RAM.</p><img alt="Linux swap" src="ss/linux_swap.jpg"><p style="margin-top:0;font-size:80%"><sup>Credit: <a href="https://blog.knoldus.com/understanding-swap-space-in-linux">Understanding Swap Space</a></sup></p><p>But there are two problems with this approach as discussed <a href="https://github.com/torvalds/linux/commit/cd67e10ac6997c6d1e1504e3c111b693bfdbc148">here</a>:</p><ul><li>Storage is far slower than RAM. So it impacts performance.</li><li>Flash storage devices like eMMC, UFS or SD card have limited life due to fixed number of read / write operations they allow. So swapping kills them quickly.</li></ul><p>So Android uses a compressed portion of RAM called <a href="https://android.googlesource.com/kernel/common/+/refs/heads/android-4.14-q/Documentation/blockdev/zram.txt">zRAM</a> for swapping. It solves both of the above problems.</p><img alt="Android zRAM" src="ss/android_zram.png"><p style="margin-top:0;font-size:80%"><sup>Credit: <a href="https://developer.android.com/topic/performance/memory-management">Android Memory Allocation</a></sup></p><p>Pages are compressed when swapped out, and then decompressed when swapped in. So zRAM keeps on growing and shrinking in size. <a href="https://github.com/mirfatif/WhatsRunning">WhatsRunning</a> shows the current state of zRAM and swap on device:</p><img alt="Android swap usage total" class="small" src="ss/swap_usage_total.jpg"><p>224 MB (196 + 28) of zRAM is holding 698 MB (334 + 91 + 273) of swapped out pages with an almost 3 times compression.</p><p>What if swapping is not enough and the device is still short on RAM? Android's <a href="https://source.android.com/devices/tech/perf/lmkd">Low Memory Killer</a> starts killing <a href="find_cached_android_apps.html">cached</a> apps. Still short on RAM? See <a href="how_to_free_ram_in_android.html">How to free RAM on Android?</a></p><hr class="dim"><p><b>Related:</b></p><ul><li><a href="swap_usage_per_process_android.html">How to view SWAP usage of apps or processes on Android?</a></li><li><a href="how_to_free_ram_in_android.html">How to free RAM on Android?</a></li></ul></div><div is="custom-div" data-custom-type="clap-button-cont"></div><div class="card"><h2>Comments</h2><comments-container></comments-container></div></div></body></html>